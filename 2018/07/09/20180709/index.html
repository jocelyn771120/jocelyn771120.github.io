<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Angr学习 （一） | Limpidity</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="shortcut icon" href="/favicon.png">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
<nav class="navbar">
    <div class="layout">
        <div class="content ">
            
            
            <a href="/.">Home</a>
            
            
            
            <a href="/archives">Archive</a>
            
            
        </div>
    </div>
</nav>

<main class="post">
    <article>
    <h1 class="article-title">
        <a href="/2018/07/09/20180709/">Angr学习 （一）</a>
    </h1>

    <section class="article-meta">
        <p class="article-date">July 09 2018</p>
    </section>

    <section class="article-entry">
        <p>练习题目地址：<a href="https://github.com/jakespringer/angr_ctf" target="_blank" rel="external">https://github.com/jakespringer/angr_ctf</a></p>
<p>前言：好久之前接触的Angr框架，用了好大劲才安装成功但是一直没仔细研究（人就是这样懒惰），这暑假有空闲的时间来学习一下这个框架。脚本注释我会写的详细一点，这样今后看着也容易理解一些。</p>
<h1 id="0x0-angr-find"><a href="#0x0-angr-find" class="headerlink" title="0x0 angr_find"></a>0x0 angr_find</h1><p><img src="http://osuzegp2h.bkt.clouddn.com/201807091.jpg" alt="images"></p>
<p>正常思路一眼就能描出flag，但是今天要利用angr框架来自动化分析</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></div><div class="line">import sys,angr</div><div class="line"></div><div class="line">def main():</div><div class="line">	</div><div class="line">	<span class="attribute">pro</span>=angr.Project('./00_angr_find')</div><div class="line">	</div><div class="line">	<span class="attribute">entry_addr</span>=pro.factory.entry_state()</div><div class="line">	</div><div class="line">	<span class="attribute">simulation</span>=pro.factory.simgr(entry_addr)</div><div class="line">	</div><div class="line">	simulation.explore(<span class="attribute">find</span>=0x0804867D)</div><div class="line">	</div><div class="line">	<span class="keyword">if</span> simulation.found:</div><div class="line">		<span class="attribute">solution</span>=simulation.found[0]</div><div class="line">		<span class="builtin-name">print</span> solution.posix.dumps(sys.stdin.fileno())</div><div class="line">		</div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="builtin-name">print</span> <span class="string">"Error"</span></div><div class="line">		</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">	main()</div><div class="line">	</div><div class="line">	</div><div class="line"><span class="comment">#任何需要符号执行的程序都要先建立一个angr工程</span></div><div class="line"><span class="comment">#factory.entry_state():返回入口点函数的值</span></div><div class="line"><span class="comment">#factory.simgr():创造一个simulation manage对象，可以收集内存，寄存器等相关信息</span></div><div class="line"><span class="comment">#explore():执行程序到相应的find位置，并且将找到的路径值放到一个list中去</span></div><div class="line"><span class="comment">#如果没有找到符合条件的路径，则打印错误</span></div></pre></td></tr></table></figure>

    </section>
</article>

</main>
<footer class="footer">
    <p>Powered by Moren YANG&nbsp;&nbsp;-&nbsp;&nbsp;ackn. <a href="https://hexo.io"> Hexo </a></p>
</footer>

</body>
</html>
